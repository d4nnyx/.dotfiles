# Install plugin
set-option -g @ssh-split-keep-cwd "true"
set-option -g @ssh-split-keep-remote-cwd "true"
set-option -g @ssh-split-fail "false"
set-option -g @ssh-split-no-env "false"
set-option -g @ssh-split-no-shell "false"
set-option -g @ssh-split-strip-cmd "true"
set-option -g @ssh-split-verbose "true"
set-option -g @ssh-split-debug "false"
set-option -g @ssh-split-h-key "|"
set-option -g @ssh-split-v-key "S"
set-option -g @ssh-split-w-key "C"
set-option -g @ssh-split-r-key "R"
set -g @plugin 'pschmitt/tmux-ssh-split'

# Enable true color (24-bit) support in tmux for terminals like screen-256color
set -ga terminal-overrides ",screen-256color*:Tc"

# Set the default terminal type inside tmux sessions
set-option -g default-terminal "screen-256color"

# Remove delay when pressing Escape or using key sequences like Ctrl+a
set -s escape-time 0

# Unbind the default tmux prefix (Ctrl+b)
unbind C-b

# Set the new prefix key to Ctrl+a (easier to reach, like GNU screen)
set-option -g prefix C-a

# Allow sending the prefix to nested tmux sessions by pressing Ctrl+a twice
bind-key C-a send-prefix

# Customize the bottom status bar color: dark background, light blue text
set -g status-style 'bg=#333333 fg=#5eacd3'

# Allow reloading this tmux config file by pressing prefix + r
bind r source-file ~/.tmux.conf

# Start window numbering at 1 instead of 0 (more intuitive for humans)
set -g base-index 1

# Use Vim-style keys (hjkl) in copy mode for moving around
set-window-option -g mode-keys vi

# In copy mode (with Vim keys), start visual selection with 'v'
bind -T copy-mode-vi v send-keys -X begin-selection

# In copy mode (with Vim keys), copy to system clipboard with 'y' using xclip
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Vim-like pane switching: move around panes using hjkl (repeatable with -r)
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Quickly jump to the last active window with Ctrl+^
bind -r ^ last-window

# Open TODO.md if it exists, otherwise fallback to personal todo file
bind -r D neww -c "#{pane_current_path}" "[[ -e TODO.md ]] && nvim TODO.md || nvim ~/.dotfiles/personal/todo.md"

# Launch the tmux-sessionizer script with prefix + f (f = find project)
bind-key -r f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

# Launch a command cheatsheet script (tmux-cht.sh)
#bind-key -r i run-shell "tmux neww tmux-cht.sh"

# Project shortcuts using tmux-sessionizer (open tmux window in specific directories)
bind-key -r ě run-shell "~/.local/bin/tmux-sessionizer ~/DEV/freelo/devops-hub"
bind-key -r š run-shell "~/.local/bin/tmux-sessionizer ~/DEV/freelo/ansible"
bind-key -r č run-shell "~/.local/bin/tmux-sessionizer ~/DEV/freelo/k8s-cluster"
bind-key -r ř run-shell "~/.local/bin/tmux-sessionizer ~/DEV/freelo/go-freelo"
#bind-key -r C run-shell "~/.local/bin/tmux-sessionizer ~/work/tvui"
#bind-key -r R run-shell "~/.local/bin/tmux-sessionizer ~/work/milo"
# bind-key -r L run-shell "~/.local/bin/tmux-sessionizer ~/work/hpack"  # Temporarily disabled
#bind-key -r H run-shell "~/.local/bin/tmux-sessionizer ~/personal/vim-with-me"
#bind-key -r T run-shell "~/.local/bin/tmux-sessionizer ~/personal/refactoring.nvim"
#bind-key -r N run-shell "~/.local/bin/tmux-sessionizer ~/personal/harpoon"
#bind-key -r S run-shell "~/.local/bin/tmux-sessionizer ~/personal/developer-productivity"
bind r source-file ~/.tmux.conf \; display-message "tmux config reloaded"
